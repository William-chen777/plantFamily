# plantFamily
整理了多个植物的蛋白组数据库，并且编写了配套程序以供调用。


**该程序用于调用plantFamily数据库，从数据库中筛选同源蛋白，并且可以返回蛋白序列或基因序列，如有需要亦可进行多重比对。**

数据库链接：https://drive.google.com/file/d/1t3gojTz9Ba3LBL4tBig-VTBE84NmKNZy/view?usp=sharing     
MUSCLE链接：https://drive.google.com/file/d/1cu8djl84Yc-pD5o1rnbS2hPyhd4j9HUU/view?usp=sharing   

## 使用教程
首先在function.py中的find_gene_family()重置数据库路径：
>species_dictionary = read_pfam_result("E:\work\plantFamily\database\json\pfamscan_result.json")

将路径修改为自己数据库存放的路径。

如果需要做多重比对的话可以下载MUSCLE软件，然后将Multi_alignment()函数中的路径修改为MUSCLE的存放路径。   
（MUSCLE软件可能出错，可以考虑在线使用：https://www.ebi.ac.uk/Tools/msa/muscle/#）

软件参数：
> python plantFamily.py -h
> Usage: python plantFamily.py [options] arg1 arg2 ...
```
Options:
  --version             show program's version number and exit
  -h, --help            show this help message and exit
  --species-info        Return species info in the database.
  --genefamily          If you specify a species, it will return the gene
                        family of that species. Otherwise, it will return the
                        gene family of 109 species.
  -s SPECIES, --species=SPECIES
                        Your target species. If 'all' is chosed, it will
                        return the gene family of 109 species.
  -p PFAM, --pfam=PFAM  Your query protein domain CLAN    .
  --homologousSeq       Returns the sequence of the homologous protein and
                        give a alignment result by muscle. -S is required.
  -S SAVEPATH, --savepath=SAVEPATH
                        Save path.
  -g, --protein2gene    Returns gene name and gene sequence.
```


### 数据库中的物种信息    
>python plantFamily.py --species-info    

反馈得到数据库中暂时包含的109个物种的蛋白组信息：      
```
'Acer_yangbiense', 'Amaranthus_hypochondriacus', 'Amborella_trichopoda', 'Aquilegia_coerulea', 'Arabidopsis_lyrata', 'Arabidopsis_thaliana', 'Arabis_nemorensis', 'Asparagus_officinalis', 'Beta_vulgaris', 'Boechera_stricta', 'Brachypodium_distachyon', 'Brassica_cretica', 'Brassica_napus', 'Brassica_oleracea', 'Brassica_rapa', 'Camelina_sativa', 'Camellia_sinensis', 'Cannabis_sativa', 'Capsella_grandiflora', 'Capsella_rubella', 'Capsicum_annuum', 'Capsicum_baccatum', 'Capsicum_chinense', 'Carica_papaya', 'Carpinus_fangiana', 'Chenopodium_quinoa', 'Cinnamomum_micranthum', 'Citrus_clementina', 'Citrus_sinensis', 'Citrus_unshiu', 'Coffea_arabica', 'Coffea_canephora', 'Coffea_eugenioides', 'Corchorus_capsularis', 'Daucus_carota', 'Durio_zibethinus', 'Eucalyptus_grandis', 'Eutrema_salsugineum', 'Fragaria_vesca', 'Ginkgo_biloba', 'Glycine_max', 'Gossypium_arboreum', 'Gossypium_barbadense', 'Gossypium_darwinii', 'Gossypium_hirsutum', 'Gossypium_raimondii', 'Helianthus_annuus', 'Herrania_umbratica', 'Hevea_brasiliensis', 'Ipomoea_nil', 'Ipomoea_triloba', 'Jatropha_curcas', 'Juglans_regia', 'Lactuca_sativa', 'Linum_usitatissimum', 'Macleaya_cordata', 'Malus_baccata', 'Malus_domestica', 'Manihot_esculenta', 'Microthlaspi_erraticum', 'Mimulus_guttatus', 'Morella_rubra', 'Morus_notabilis', 'Musa_acuminata', 'Nelumbo_nucifera', 'Nicotiana_attenuata', 'Nicotiana_sylvestris', 'Nicotiana_tabacum', 'Nicotiana_tomentosiformis', 'Nymphaea_colorata', 'Nymphaea_thermarum', 'Olea_europaea', 'Oryza_brachyantha', 'Oryza_sativa', 'Panicum_virgatum', 'Papaver_somniferum', 'Parasponia_andersonii', 'Phaseolus_vulgaris', 'Physcomitrella_patens', 'Pistacia_vera', 'Populus_alba', 'Populus_euphratica', 'Populus_trichocarpa', 'Prunus_avium', 'Prunus_dulcis', 'Prunus_mume', 'Prunus_persica', 'Punica_granatum', 'Pyrus_bretschneideri', 'Quercus_lobata', 'Quercus_suber', 'Raphanus_sativus', 'Rhamnella_rubrinervis', 'Ricinus_communis', 'Rosa_chinensis', 'Salix_brachista', 'Salix_purpurea', 'Setaria_italica', 'Solanum_chilense', 'Solanum_lycopersicum', 'Solanum_pennellii', 'Solanum_tuberosum', 'Sorghum_bicolor', 'Spinacia_oleracea', 'Tarenaya_hassleriana', 'Theobroma_cacao', 'Trema_orientale', 'Vitis_riparia', 'Vitis_vinifera', 'Zea_mays'      
```

### 寻找同源基因
首先，一个蛋白编码基因的功能主要由domain决定，同源基因家族的成员具有相同的功能，所以我们可以通过domain确定家族成员。
在PFAM蛋白预测网站(http://pfam.xfam.org/)预测查询蛋白的domain：
```
此处随机选取Oryza sativa的NP_039373蛋白：
>TXG46240.1 hypothetical protein EZV62_028271 [Acer yangbiense]
MLRNGNEGMSTIPGFSQIQFEGFCRFINQGLAEELEKFPTIKDPDHEISFQLFAKGYQLLEPSIKERDAV
YESLTYSSELYVSARLIFGFDVQKQTISIGNIPIMNSLGTFIINGIYRIVINQILLSPGIYYRSELDHKG
ISIYTGTIISDWGGRSELAIDKKERIWARVSRKQKISILVLSSAMGSNLKEILDNVSYPEIFLSFPNAKE
KKRIESKEKAILEFYQQFACVGGDLVFSESLCEELQKKFFQQKCELGRIGRRNMNRRLNLDIPQNSTFLL
PRDVLAATDHLIGMKFETGILDDDDMNHLKNKRIRSVADLLQDQFGLALGRLQHAVQKTIRRVFIRQSKP
TPQTLVTPTSTSILLITTYETFFGTYPLSQVFDQTNPLTQTVHGRKVSCLGPGGLTGRTASFRSRDIHPS
HYGRICPIDTSEGINVGLTGSLAIHARIDHWWGSVESPFYEISEKAKKKKERQVVYLSPNRDEYYMIAAG
NSLSLNRGIQEEQVVPARYRQEFLTIAWEQIHVRSIFPFQYFSIGGSLIPFIEHNDANRALMSSNMQRQA
VPLSRSEKCIVGTGLERQTALDSRVSVIAEREGKIISTNSHKILLSSSGKTISIPLVTHRRSNKNTCMHQ
KPRVPRGKSIKKGQILAEGAATVGGELALGKNVLVAYMPWEGYNFEDAVLISERLVYEDIYTSFHIRKYE
IQTDTTSQGSAEKITKEIPHLEEHLLRNLDRNGVVKLGSWVETGDILVGKLTPQIASESSYIAEAGLLRA
IFGLEVSTSKETSLKLPIGGRGRVIDVKWIQRDPLDIMVRVYILQKREIKVGDKVAGRHGNKGIISKILP
RQDMPYLQDGTPVDMVFNPLGVPSRMNVGQIFESSLGLAGDLLKKHYRIAPFDERYEQEASRKLVFSELY
EASKQTKNPWVFEPEYPGKSRIFDGRTGDPFEQPVLIGKSYILKLIHQVDEKIHGRSTGPYSLVTQQPVR
GRAKQGGQRIGEMEVWALEGFGVAHILQEILTYKSDHLIARQEILNATIWGKRVPNHEDPPESFRVLVRE
LRSLALELNHFLVSQKNFQVNREEV
```     
在网站中提交查询的蛋白序列：
![image](https://user-images.githubusercontent.com/51122862/162757989-e5e0a6d2-81df-46a5-a87d-c8606a7ec94c.png)

结果反馈的是该蛋白的结构信息，我们点击domain，确定其familyID，通常会选择出现次数最多或者最长domain(比较严谨的话会选择所有domain)：
![image](https://user-images.githubusercontent.com/51122862/162763827-84ed29bd-a07c-447d-a69c-0f738a4212f5.png)
![image](https://user-images.githubusercontent.com/51122862/162763901-bdf622a6-9a8f-4285-849d-2e47a73033b3.png)


剩下的就交给plantFamily了(仅作演示，为了节省时间我选取了全部domain)：    
如果只要知道在指定物种中的同源基因，需要在-s后加上指定的物种；如果需要知道在109个物种中的同源基因可以加all
> python plantFamily.py --genefamily -s Oryza_sativa -p PF04563,PF00562

```
Reading json data ...
Finished reading!
Now is searching Oryza_sativa...
Finished searching!
['XP_015632810.1', 'XP_015636222.1', 'XP_015614312.1', 'XP_015648872.1', 'XP_015631661.1', 'XP_015632811.1', 'XP_025880655.1', 'XP_025880656.1', 'NP_039373.1', 'XP_015632812.1']

```     

> python plantFamily.py --genefamily -s all -p PF04563,PF00562     

```
Reading json data ...
Finished reading!
Now is searching Acer_yangbiense...
Finished searching!
Now is searching Amaranthus_hypochondriacus...
Finished searching!
Now is searching Amborella_trichopoda...
Finished searching!
Now is searching Aquilegia_coerulea...
Finished searching!
Now is searching Arabidopsis_lyrata...
Finished searching!
Now is searching Arabidopsis_thaliana...
Finished searching!
Now is searching Arabis_nemorensis...
Finished searching!
Now is searching Asparagus_officinalis...
Finished searching!
Now is searching Beta_vulgaris...
Finished searching!
Now is searching Boechera_stricta...
Finished searching!
Now is searching Brachypodium_distachyon...
Finished searching!
Now is searching Brassica_cretica...
Finished searching!
Now is searching Brassica_napus...
Finished searching!
Now is searching Brassica_oleracea...
Finished searching!
Now is searching Brassica_rapa...
Finished searching!
Now is searching Camelina_sativa...
Finished searching!
Now is searching Camellia_sinensis...
Finished searching!
Now is searching Cannabis_sativa...
Finished searching!
Now is searching Capsella_grandiflora...
Finished searching!
Now is searching Capsella_rubella...
Finished searching!
Now is searching Capsicum_annuum...
Finished searching!
Now is searching Capsicum_baccatum...
Finished searching!
Now is searching Capsicum_chinense...
Finished searching!
Now is searching Carica_papaya...
Finished searching!
Now is searching Carpinus_fangiana...
Finished searching!
Now is searching Chenopodium_quinoa...
Finished searching!
Now is searching Cinnamomum_micranthum...
Finished searching!
Now is searching Citrus_clementina...
Finished searching!
Now is searching Citrus_sinensis...
Finished searching!
Now is searching Citrus_unshiu...
Finished searching!
Now is searching Coffea_arabica...
Finished searching!
Now is searching Coffea_canephora...
Finished searching!
Now is searching Coffea_eugenioides...
Finished searching!
Now is searching Corchorus_capsularis...
Finished searching!
Now is searching Daucus_carota...
Finished searching!
Now is searching Durio_zibethinus...
Finished searching!
Now is searching Eucalyptus_grandis...
Finished searching!
Now is searching Eutrema_salsugineum...
Finished searching!
Now is searching Fragaria_vesca...
Finished searching!
Now is searching Ginkgo_biloba...
Finished searching!
Now is searching Glycine_max...
Finished searching!
Now is searching Gossypium_arboreum...
Finished searching!
Now is searching Gossypium_barbadense...
Finished searching!
Now is searching Gossypium_darwinii...
Finished searching!
Now is searching Gossypium_hirsutum...
Finished searching!
Now is searching Gossypium_raimondii...
Finished searching!
Now is searching Helianthus_annuus...
Finished searching!
Now is searching Herrania_umbratica...
Finished searching!
Now is searching Hevea_brasiliensis...
Finished searching!
Now is searching Ipomoea_nil...
Finished searching!
Now is searching Ipomoea_triloba...
Finished searching!
Now is searching Jatropha_curcas...
Finished searching!
Now is searching Juglans_regia...
Finished searching!
Now is searching Lactuca_sativa...
Finished searching!
Now is searching Linum_usitatissimum...
Finished searching!
Now is searching Macleaya_cordata...
Finished searching!
Now is searching Malus_baccata...
Finished searching!
Now is searching Malus_domestica...
Finished searching!
Now is searching Manihot_esculenta...
Finished searching!
Now is searching Microthlaspi_erraticum...
Finished searching!
Now is searching Mimulus_guttatus...
Finished searching!
Now is searching Morella_rubra...
Finished searching!
Now is searching Morus_notabilis...
Finished searching!
Now is searching Musa_acuminata...
Finished searching!
Now is searching Nelumbo_nucifera...
Finished searching!
Now is searching Nicotiana_attenuata...
Finished searching!
Now is searching Nicotiana_sylvestris...
Finished searching!
Now is searching Nicotiana_tabacum...
Finished searching!
Now is searching Nicotiana_tomentosiformis...
Finished searching!
Now is searching Nymphaea_colorata...
Finished searching!
Now is searching Nymphaea_thermarum...
Finished searching!
Now is searching Olea_europaea...
Finished searching!
Now is searching Oryza_brachyantha...
Finished searching!
Now is searching Oryza_sativa...
Finished searching!
Now is searching Panicum_virgatum...
Finished searching!
Now is searching Papaver_somniferum...
Finished searching!
Now is searching Parasponia_andersonii...
Finished searching!
Now is searching Phaseolus_vulgaris...
Finished searching!
Now is searching Physcomitrella_patens...
Finished searching!
Now is searching Pistacia_vera...
Finished searching!
Now is searching Populus_alba...
Finished searching!
Now is searching Populus_euphratica...
Finished searching!
Now is searching Populus_trichocarpa...
Finished searching!
Now is searching Prunus_avium...
Finished searching!
Now is searching Prunus_dulcis...
Finished searching!
Now is searching Prunus_mume...
Finished searching!
Now is searching Prunus_persica...
Finished searching!
Now is searching Punica_granatum...
Finished searching!
Now is searching Pyrus_bretschneideri...
Finished searching!
Now is searching Quercus_lobata...
Finished searching!
Now is searching Quercus_suber...
Finished searching!
Now is searching Raphanus_sativus...
Finished searching!
Now is searching Rhamnella_rubrinervis...
Finished searching!
Now is searching Ricinus_communis...
Finished searching!
Now is searching Rosa_chinensis...
Finished searching!
Now is searching Salix_brachista...
Finished searching!
Now is searching Salix_purpurea...
Finished searching!
Now is searching Setaria_italica...
Finished searching!
Now is searching Solanum_chilense...
Finished searching!
Now is searching Solanum_lycopersicum...
Finished searching!
Now is searching Solanum_pennellii...
Finished searching!
Now is searching Solanum_tuberosum...
Finished searching!
Now is searching Sorghum_bicolor...
Finished searching!
Now is searching Spinacia_oleracea...
Finished searching!
Now is searching Tarenaya_hassleriana...
Finished searching!
Now is searching Theobroma_cacao...
Finished searching!
Now is searching Trema_orientale...
Finished searching!
Now is searching Vitis_riparia...
Finished searching!
Now is searching Vitis_vinifera...
Finished searching!
Now is searching Zea_mays...
Finished searching!
{'Acer_yangbiense': ['TXG71432.1', 'TXG65977.1', 'TXG71425.1', 'TXG56870.1', 'TXG46662.1', 'TXG49176.1', 'TXG71433.1', 'TXG67319.1'], 'Amaranthus_hypochondriacus': ['AH000334-RA', 'AH015654-RA', 'AH023260-RA'
], 'Amborella_trichopoda': ['XP_020519941.1', 'XP_020526558.1', 'XP_006827132.3', 'XP_020526559.1', 'XP_020519934.1', 'XP_006859038.1', 'XP_020519928.1', 'XP_020532114.1', 'XP_020526556.1', 'XP_020526557.1',
'XP_020522077.1', 'NP_904091.2', 'XP_020522076.1'], 'Aquilegia_coerulea': ['PIA29535.1', 'PIA61733.1', 'PIA29533.1', 'PIA60123.1', 'PIA61730.1', 'PIA61731.1', 'PIA55356.1', 'PIA61732.1', 'PIA28536.1', 'PIA295
34.1', 'PIA55355.1'], 'Arabidopsis_lyrata': ['XP_020887712.1', 'XP_020868699.1', 'XP_020868700.1', 'XP_002883108.1', 'XP_020882644.1', 'XP_020887105.1', 'XP_002863522.1', 'XP_020882646.1', 'XP_002867829.1', '
YP_009357259.1'], 'Arabidopsis_thaliana': ['NP_001332059.1', 'NP_001326261.1', 'NP_188437.2', 'NP_193902.1', 'NP_001189957.1', 'NP_001332060.1', 'NP_564341.2', 'NP_001326262.1', 'NP_051051.1', 'NP_199327.4',
'NP_189020.2'], 'Arabis_nemorensis': ['VVA93013.1', 'VVA98074.1', 'VVA99127.1', 'VVB07992.1', 'VVB12169.1'], 'Asparagus_officinalis': ['XP_020263708.1', 'XP_020264048.1', 'XP_020255590.1', 'XP_020263607.1', '
XP_020263709.1'], 'Beta_vulgaris': ['XP_010692847.1', 'XP_010692846.1', 'XP_010667543.1', 'XP_010670529.1', 'XP_010667540.1', 'XP_010686499.1'], 'Boechera_stricta': ['Bostr.30275s0118.1.p', 'Bostr.19424s0861.
1.p', 'Bostr.10689s0130.1.p', 'Bostr.19424s0861.2.p'], 'Brachypodium_distachyon': ['XP_024317552.1', 'YP_002000478.1', 'XP_003561873.1', 'XP_003571431.1', 'XP_010237620.1', 'XP_003564776.1', 'XP_003570586.1',
 'XP_014758470.1', 'XP_024319221.1', 'XP_003574126.1', 'XP_010240509.1'], 'Brassica_cretica': ['KAF3580030.1', 'KAF3544316.1', 'KAF3592478.1', 'KAF3534910.1', 'KAF3592007.1'], 'Brassica_napus': ['XP_013642981
.1', 'XP_022570861.1', 'XP_022551632.1', 'XP_013736979.1', 'XP_013685975.1', 'XP_013697352.1', 'XP_013685976.1', 'XP_022562089.1', 'XP_013650549.1', 'XP_013681684.1', 'XP_022575329.1', 'XP_013687385.1', 'XP_0
22562090.1', 'XP_013681683.1', 'XP_013687394.1', 'XP_013650550.2', 'XP_013656137.1', 'XP_013687382.1', 'XP_013728433.1', 'XP_022557871.1', 'YP_005089944.1', 'XP_022557870.1', 'XP_013673965.2', 'XP_013718067.1
'], 'Brassica_oleracea': ['XP_013597647.1', 'XP_013598952.1', 'XP_013598953.1', 'XP_013632372.1', 'XP_013621532.1', 'XP_013598951.1', 'XP_013621533.1', 'XP_013598194.1'], 'Brassica_rapa': ['XP_033129118.1', '
XP_009102799.2', 'XP_009135083.2', 'XP_009101622.2', 'XP_033133202.1', 'XP_018514761.1', 'XP_033133206.1', 'XP_009137207.2', 'XP_033139395.1', 'XP_009101620.2', 'XP_009108527.2', 'XP_033133205.1', 'XP_0091459
36.1', 'XP_033133879.1', 'XP_033133204.1'], 'Camelina_sativa': ['XP_010460770.1', 'XP_010490096.1', 'XP_019088672.1', 'XP_010499511.1', 'XP_019083282.1', 'XP_010466799.1', 'XP_010466726.1', 'XP_010494587.1',
'XP_010434140.1', 'XP_010460771.1', 'XP_010466727.1', 'XP_019087793.1', 'XP_010466796.1', 'XP_010466795.1', 'XP_010478367.1'], 'Camellia_sinensis': ['XP_028094735.1', 'XP_028105689.1', 'XP_028083743.1', 'XP_0
28071688.1', 'XP_028083749.1', 'XP_028081712.1', 'XP_028108997.1', 'XP_028083748.1', 'XP_028083747.1', 'XP_028083745.1', 'XP_028083744.1', 'XP_028081718.1', 'XP_028105690.1', 'YP_007317240.1'], 'Cannabis_sati
va': ['XP_030497299.1', 'XP_030482853.1', 'XP_030500625.1', 'XP_030481031.1', 'XP_030497298.1', 'XP_030482844.1', 'XP_030502739.1', 'XP_030482860.1'], 'Capsella_grandiflora': ['Cagra.0104s0002.1.p', 'Cagra.01
04s0002.2.p', 'Cagra.3519s0022.1.p', 'Cagra.0779s0008.1.p', 'Cagra.5647s0021.1.p'], 'Capsella_rubella': ['XP_023633093.1', 'XP_006279912.1', 'XP_006285577.1', 'XP_023635781.1', 'XP_023641577.1'], 'Capsicum_an
nuum': ['YP_006666022.1', 'XP_016563843.1', 'XP_016571806.1', 'XP_016558259.1', 'XP_016563842.1', 'XP_016543902.1', 'XP_016541552.1', 'XP_016543900.1', 'XP_016543899.1', 'XP_016537583.1'], 'Capsicum_baccatum'
: ['PHT43425.1', 'PHT55951.1', 'PHT58638.1', 'PHT59674.1', 'PHT54972.1', 'PHT53681.1', 'PHT37095.1', 'PHT60196.1', 'PHT51633.1'], 'Capsicum_chinense': ['PHU06102.1', 'PHU26447.1', 'PHU28834.1', 'PHU06115.1',
'PHU23638.1', 'PHU07678.1', 'PHU06006.1', 'PHU06100.1'], 'Carica_papaya': ['XP_021902259.1', 'YP_001671675.1', 'XP_021890660.1', 'XP_021888372.1'], 'Carpinus_fangiana': ['KAB8446166.1', 'KAE8056273.1', 'KAE79
95674.1', 'KAB8346180.1', 'KAE8038435.1', 'KAB8339007.1', 'KAE8056274.1'], 'Chenopodium_quinoa': ['XP_021729289.1', 'XP_021756497.1', 'YP_009380122.1', 'XP_021724466.1', 'XP_021766326.1', 'XP_021756496.1', 'X
P_021732241.1', 'XP_021739245.1', 'XP_021735766.1', 'XP_021740593.1', 'XP_021726447.1'], 'Cinnamomum_micranthum': ['RWR84043.1', 'RWR77870.1', 'RWR74823.1', 'RWR89584.1'], 'Citrus_clementina': ['XP_006423594.
1', 'XP_024038917.1', 'XP_006442883.1', 'XP_006428126.2', 'XP_006432385.1'], 'Citrus_sinensis': ['XP_006464287.1', 'XP_006478802.1', 'YP_740467.1', 'XP_024949824.1', 'XP_024949825.1', 'XP_024954279.1', 'XP_02
4949823.1', 'XP_006487405.1'], 'Citrus_unshiu': ['GAY63272.1', 'GAY63271.1', 'GAY44344.1', 'GAY64512.1', 'GAY64509.1', 'GAY63274.1', 'GAY65365.1', 'GAY44345.1', 'GAY44346.1', 'GAY53306.1', 'GAY63273.1'], 'Cof
fea_arabica': ['XP_027062537.1', 'XP_027084782.1', 'XP_027068856.1', 'XP_027111781.1', 'XP_027081150.1', 'XP_027105272.1', 'XP_027127095.1', 'YP_817474.1', 'XP_027122892.1', 'XP_027111780.1', 'XP_027096132.1'
, 'XP_027105271.1'], 'Coffea_canephora': ['CDP07172.1', 'CDP07938.1', 'CDP14782.1', 'CDO99545.1', 'CDP09677.1', 'CDO98608.1'], 'Coffea_eugenioides': ['XP_027182551.1', 'XP_027150994.1', 'XP_027172620.1', 'XP_
027167246.1', 'XP_027150898.1', 'XP_027167245.1', 'XP_027163918.1', 'XP_027167247.1'], 'Corchorus_capsularis': ['OMO51312.1', 'OMO76425.1', 'OMO59279.1', 'OMO61577.1'], 'Daucus_carota': ['DCAR_003109', 'DCAR_
009948', 'DCAR_019382', 'DCAR_022858', 'DCAR_022371', 'DCAR_004076'], 'Durio_zibethinus': ['XP_022747863.1', 'XP_022729296.1', 'XP_022747865.1', 'XP_022747864.1', 'XP_022723357.1', 'XP_022748401.1', 'XP_02274
7869.1', 'XP_022747866.1', 'XP_022729297.1', 'XP_022723358.1'], 'Eucalyptus_grandis': ['Eucgr.E03313.1.p', 'Eucgr.C00069.1.p', 'Eucgr.G03213.2.p', 'Eucgr.A00794.1.p', 'Eucgr.E03313.2.p', 'Eucgr.G03213.1.p'],
'Eutrema_salsugineum': ['XP_006413743.1', 'XP_024007792.1', 'XP_006406653.1', 'XP_006398163.1', 'XP_024007983.1', 'XP_006415532.1'], 'Fragaria_vesca': ['XP_004300118.1', 'XP_004307166.1', 'YP_004286094.1', 'X
P_004294022.1', 'XP_004308665.1', 'XP_004288915.1'], 'Ginkgo_biloba': ['Gb_31802', 'Gb_32298', 'Gb_30006'], 'Glycine_max': ['Glyma07g14995.1|PACid:26350172', 'Glyma04g06440.2|PACid:26304432', 'Glyma01g00975.1
|PACid:26324510', 'Glyma07g14995.2|PACid:26350173', 'Glyma15g08000.2|PACid:26330923', 'Glyma15g18790.1|PACid:26332669', 'Glyma17g23500.3|PACid:26312070', 'Glyma06g06480.1|PACid:26299108', 'Glyma13g26190.1|PAC
id:26316415', 'Glyma09g07570.1|PACid:26341385'], 'Gossypium_arboreum': ['YP_005088991.1', 'XP_017615303.1', 'XP_017611167.1', 'XP_017611168.1', 'XP_017611165.1', 'XP_017610878.1', 'XP_017611164.1', 'XP_017641
874.1', 'XP_017641873.1', 'XP_017608025.1'], 'Gossypium_barbadense': ['KAB2079244.1', 'KAB2063251.1', 'KAB2026799.1', 'KAB2033445.1', 'KAB2026798.1', 'KAB2085730.1', 'KAB2001587.1', 'KAB2001586.1', 'KAB202000
9.1', 'KAB2072746.1', 'KAB2010197.1'], 'Gossypium_darwinii': ['TYH14759.1', 'TYG51203.1', 'TYG66328.1', 'TYG99853.1', 'TYG60081.1', 'TYH13749.1', 'TYG72425.1', 'TYH20643.1', 'TYH08725.1', 'TYG92120.1'], 'Goss
ypium_hirsutum': ['XP_040961304.1', 'XP_040936347.1', 'XP_016714180.2', 'XP_040933906.1', 'XP_016751988.2', 'XP_040973178.1', 'XP_040972371.1', 'YP_538927.1', 'XP_040972372.1', 'XP_016744620.2', 'XP_040972373
.1', 'XP_040970469.1', 'XP_040961305.1', 'XP_016699823.2', 'XP_016751986.2'], 'Gossypium_raimondii': ['XP_012449723.1', 'XP_012452401.1', 'XP_012459628.1', 'XP_012455618.1', 'YP_005087685.1', 'XP_012449722.1'
], 'Helianthus_annuus': ['Ha14_00020179-RA', 'Ha15_00039155-RA', 'Ha4_00025468-RA', 'Ha5_00005264-RA', 'Ha11_00028471-RA', 'Ha11_00030296-RA'], 'Herrania_umbratica': ['XP_021283499.1', 'XP_021277437.1', 'XP_0
21294485.1', 'XP_021299959.1'], 'Hevea_brasiliensis': ['XP_021657771.1', 'YP_004327649.1', 'XP_021683417.1', 'XP_021683285.1', 'XP_021683277.1', 'XP_021683429.1', 'XP_021644948.1'], 'Ipomoea_nil': ['XP_019170
650.1', 'XP_019162258.1', 'YP_009295096.1', 'XP_019192937.1', 'XP_019152211.1', 'XP_019167919.1'], 'Ipomoea_triloba': ['XP_031118457.1', 'YP_009491717.1', 'XP_031127210.1', 'XP_031127399.1', 'XP_031122692.1',
 'XP_031106042.1', 'XP_031118456.1'], 'Jatropha_curcas': ['XP_012076429.2', 'XP_012068721.1', 'YP_002720104.1', 'XP_012068704.1', 'XP_012091599.1', 'XP_037495307.1'], 'Juglans_regia': ['XP_018820168.1', 'XP_0
18823942.1', 'XP_018818349.1', 'XP_018818342.1', 'XP_018839587.2', 'XP_018818353.1', 'YP_009186160.1'], 'Lactuca_sativa': ['XP_023757453.1', 'YP_398316.1', 'XP_023744510.1', 'XP_023756456.1', 'XP_023766539.1'
, 'XP_023732824.1', 'XP_023757454.1', 'XP_023757782.1', 'XP_023757452.1', 'XP_023744509.1', 'XP_023757783.1'], 'Linum_usitatissimum': ['Lus10011182', 'Lus10039677', 'Lus10028778', 'Lus10015446', 'Lus10027166'
, 'Lus10026157', 'Lus10011322', 'Lus10017504'], 'Macleaya_cordata': ['OVA14931.1', 'OVA01980.1', 'OVA18521.1', 'OVA01264.1', 'OVA14930.1'], 'Malus_baccata': ['TQD71131.1', 'TQE11178.1', 'TQE06255.1', 'TQD8836
0.1', 'TQE00167.1', 'TQD69993.1'], 'Malus_domestica': ['XP_028963223.1', 'XP_008379020.2', 'XP_008383740.2', 'XP_008379016.2', 'XP_008367325.2', 'XP_028959009.1', 'XP_008357267.2'], 'Manihot_esculenta': ['XP_
021610008.1', 'YP_001718429.1', 'XP_021596379.1', 'XP_021607352.1', 'XP_021610202.1', 'XP_021610009.1', 'XP_021610010.1', 'XP_021596788.1', 'XP_021610203.1'], 'Microthlaspi_erraticum': ['CAA7030035.1', 'CAA70
57341.1', 'CAA7054694.1', 'CAA7013057.1', 'CAA7026043.1', 'CAA7062188.1'], 'Mimulus_guttatus': ['Migut.E01463.1.p', 'Migut.M00297.1.p', 'Migut.B01339.1.p', 'Migut.H01489.1.p', 'Migut.B01180.1.p', 'Migut.B0118
1.1.p'], 'Morella_rubra': ['KAB1200832.1', 'KAB1222256.1', 'KAB1200828.1', 'KAB1204698.1', 'KAB1201047.1', 'KAB1200829.1'], 'Morus_notabilis': ['XP_024031417.1', 'XP_024031416.1', 'XP_024024074.1', 'XP_010101
029.1', 'XP_024024075.1', 'XP_010108197.1'], 'Musa_acuminata': ['XP_009413519.1', 'XP_018684753.1', 'XP_009414083.1', 'XP_009385728.1', 'XP_009413518.1'], 'Nelumbo_nucifera': ['XP_010275247.1', 'XP_010242621.
1', 'XP_019055826.1', 'XP_010242622.1', 'XP_010242918.1', 'YP_009093942.1'], 'Nicotiana_attenuata': ['XP_019245498.1', 'XP_019226923.1', 'XP_019252729.1', 'XP_019266211.1', 'XP_019252739.1', 'XP_019252735.1',
 'XP_019266160.1', 'XP_019250632.1'], 'Nicotiana_sylvestris': ['XP_016515970.1', 'XP_016446527.1', 'XP_016515971.1', 'XP_016515972.1', 'NP_054488.1', 'XP_016465823.1', 'XP_016487083.1', 'XP_016492170.1', 'XP_
016433825.1', 'XP_016492974.1', 'XP_016481856.1', 'XP_016499992.1'], 'Nicotiana_tabacum': ['XP_016515970.1', 'XP_016446527.1', 'XP_016515971.1', 'XP_016515972.1', 'NP_054488.1', 'XP_016465823.1', 'XP_01648708
3.1', 'XP_016492170.1', 'XP_016433825.1', 'XP_016492974.1', 'XP_016481856.1', 'XP_016499992.1'], 'Nicotiana_tomentosiformis': ['XP_009604369.1', 'XP_018632653.1', 'YP_398851.1', 'XP_009605280.1', 'XP_00962238
5.1', 'XP_009605281.1', 'XP_018632652.1', 'XP_009605686.1', 'XP_018627285.1', 'XP_009623390.1'], 'Nymphaea_colorata': ['XP_031475055.1', 'XP_031504146.1', 'XP_031475780.1', 'XP_031475778.1', 'XP_031475777.1',
 'XP_031475059.1', 'XP_031475054.1'], 'Nymphaea_thermarum': ['KAF3789669.1', 'KAF3794981.1'], 'Olea_europaea': ['XP_022862473.1', 'XP_022874083.1', 'XP_022895779.1', 'XP_022845642.1', 'XP_022895778.1', 'YP_00
4376413.1'], 'Oryza_brachyantha': ['XP_006661904.2', 'YP_009266412.1', 'XP_006650345.3', 'XP_006652896.1', 'XP_040383192.1', 'XP_015694372.2'], 'Oryza_sativa': ['XP_015614312.1', 'XP_025880655.1', 'XP_0156316
61.1', 'XP_015636222.1', 'XP_025880656.1', 'XP_015632810.1', 'NP_039373.1', 'XP_015648872.1', 'XP_015632811.1', 'XP_015632812.1'], 'Panicum_virgatum': ['XP_039817835.1', 'XP_039827057.1', 'XP_039822102.1', 'X
P_039787809.1', 'XP_039839751.1', 'XP_039830932.1', 'XP_039853017.1', 'YP_004841939.1', 'XP_039783779.1', 'XP_039783781.1', 'XP_039787808.1', 'XP_039783780.1', 'XP_039774206.1', 'XP_039830930.1', 'XP_03978321
9.1'], 'Papaver_somniferum': ['XP_026419192.1', 'XP_026426571.1', 'XP_026386057.1', 'XP_026448492.1', 'XP_026378987.1', 'XP_026414248.1', 'XP_026415367.1', 'XP_026426107.1', 'XP_026426106.1', 'XP_026382002.1'
, 'XP_026426105.1', 'XP_026415368.1', 'YP_009234974.1'], 'Parasponia_andersonii': ['PON74552.1', 'PON51750.1', 'PON58426.1', 'PON53168.1'], 'Phaseolus_vulgaris': ['Phvul.009G230400.4.p', 'Phvul.009G230400.2.p
', 'Phvul.009G230400.1.p', 'Phvul.011G201300.1.p', 'Phvul.006G185800.1.p', 'Phvul.004G175000.1.p', 'Phvul.009G230400.3.p', 'Phvul.009G087100.1.p'], 'Physcomitrella_patens': ['Pp3c18_11070V3.5', 'Pp3c4_16140V3
.3', 'Pp3c15_16480V3.1', 'Pp3c18_11070V3.2', 'Pp3c15_16480V3.2', 'Pp3c18_11070V3.1', 'Pp3c4_16140V3.2', 'Pp3c5_14880V3.1', 'Pp3c2_10910V3.1', 'Pp3c18_11070V3.4', 'Pp3c2_10910V3.2', 'Pp3c18_11070V3.3', 'Pp3c18
_11070V3.7', 'Pp3c5_14880V3.2', 'Pp3c4_16140V3.1'], 'Pistacia_vera': ['XP_031252214.1', 'YP_009383624.1', 'XP_031272883.1', 'XP_031279702.1', 'XP_031279700.1', 'XP_031288309.1'], 'Populus_alba': ['YP_665550.1
', 'XP_034912453.1', 'XP_034917568.1', 'XP_034907966.1', 'XP_034921198.1', 'XP_034907967.1'], 'Populus_euphratica': ['XP_011027835.1', 'XP_011003287.1', 'XP_011000622.1', 'XP_011003286.1', 'XP_011036682.1', '
YP_009054421.1'], 'Populus_trichocarpa': ['XP_024441929.1', 'XP_024446281.1', 'XP_024446282.1', 'XP_024441930.1', 'XP_024444830.1', 'XP_024446280.1', 'XP_024439131.1', 'YP_001109491.1', 'XP_024454924.1'], 'Pr
unus_avium': ['XP_021802753.1', 'XP_021825796.1', 'XP_021821013.1', 'XP_021821012.1', 'XP_021824674.1'], 'Prunus_dulcis': ['XP_034211427.1', 'XP_034211426.1', 'XP_034203192.1', 'XP_034198992.1', 'XP_034203193
.1', 'XP_034203196.1', 'XP_034203195.1', 'XP_034203194.1', 'XP_034208415.1', 'XP_034203189.1', 'XP_034198993.1', 'YP_009366334.1', 'XP_034203191.1'], 'Prunus_mume': ['XP_008225092.1', 'XP_008220676.1', 'YP_00
9020030.1', 'XP_008218570.1'], 'Prunus_persica': ['XP_007214559.1', 'XP_007225442.1', 'YP_004021657.1', 'XP_020413070.1', 'XP_020413069.1', 'XP_020419458.1'], 'Punica_granatum': ['XP_031388012.1', 'XP_0313829
17.1', 'XP_031389956.1', 'XP_031382916.1', 'XP_031382915.1', 'XP_031376042.1', 'XP_031376043.1', 'XP_031389955.1', 'XP_031381316.1', 'YP_009390801.1'], 'Pyrus_bretschneideri': ['XP_009363667.1', 'XP_009363651
.1', 'XP_009363658.1', 'XP_009352922.1', 'XP_009355261.1', 'XP_009350748.1', 'XP_009339281.1', 'XP_009366734.1', 'XP_018500918.1', 'XP_009355260.1', 'XP_009363676.1'], 'Quercus_lobata': ['XP_030967887.1', 'XP
_030968245.1', 'XP_030951247.1', 'XP_030966434.1'], 'Quercus_suber': ['XP_023878777.1', 'XP_023893249.1', 'XP_023896905.1', 'XP_023899750.1', 'XP_023877419.1', 'XP_023888531.1', 'XP_023919645.1', 'XP_02389406
2.1', 'XP_023907142.1', 'XP_023894061.1'], 'Raphanus_sativus': ['XP_018471169.1', 'XP_018487825.1', 'XP_018485070.1', 'YP_009046906.1', 'XP_018434456.1', 'XP_018451275.1', 'XP_018447597.1', 'XP_018451276.1',
'XP_018485069.1', 'XP_018489679.1', 'XP_018483839.1', 'XP_018451274.1'], 'Rhamnella_rubrinervis': ['KAF3444457.1', 'KAF3449773.1', 'KAF3446197.1', 'KAF3434232.1', 'KAF3451484.1', 'KAF3451172.1'], 'Ricinus_com
munis': ['XP_015581357.1', 'XP_015581358.1', 'XP_002519060.1', 'YP_005090170.1', 'XP_002515428.1', 'XP_015578752.1'], 'Rosa_chinensis': ['XP_024180531.1', 'XP_040371757.1', 'XP_024180530.1', 'XP_040371752.1',
 'XP_024168781.1', 'XP_024199247.1', 'XP_024167172.1', 'XP_040362078.1', 'XP_024188625.1'], 'Salix_brachista': ['KAB5560599.1', 'KAB5573021.1', 'KAB5511206.1', 'KAB5524030.1'], 'Salix_purpurea': ['Sapur.15ZG0
02000.3.p', 'Sapur.15WG002000.2.p', 'Sapur.15ZG002000.1.p', 'Sapur.018G014200.2.p', 'Sapur.018G014200.4.p', 'Sapur.001G025400.1.p', 'Sapur.15WG002000.3.p', 'Sapur.004G028500.1.p', 'Sapur.018G014200.3.p', 'Sap
ur.15WG002000.1.p', 'Sapur.018G014200.1.p', 'Sapur.15ZG002000.2.p'], 'Setaria_italica': ['XP_004972737.3', 'XP_004951189.1', 'XP_012698556.2', 'XP_004982316.1', 'XP_012703111.1', 'XP_022684018.1', 'YP_0088157
41.1'], 'Solanum_chilense': ['TMX00858.1', 'TMW95667.1', 'TMW88614.1', 'TMX04220.1', 'TMW87826.1', 'TMW86523.1', 'TMX02258.1'], 'Solanum_lycopersicum': ['NP_001234825.1', 'XP_010312066.1', 'XP_004236361.1', '
NP_001233889.1', 'XP_004229596.1', 'XP_010312068.1', 'XP_019066807.1', 'YP_008563080.1', 'XP_010325603.2', 'XP_025884244.1', 'XP_010312067.1', 'XP_004245914.1'], 'Solanum_pennellii': ['XP_015066015.1', 'XP_01
5056028.1', 'XP_015055304.1', 'XP_027768151.1', 'XP_015056027.1', 'XP_027769270.1', 'XP_015061653.1', 'XP_015084042.1', 'XP_015069884.1'], 'Solanum_tuberosum': ['YP_635631.1', 'XP_015159439.1', 'XP_006351506.
1', 'XP_006350058.1', 'XP_006366498.1', 'XP_006347043.1', 'XP_006362215.1', 'XP_006364477.1', 'XP_006362278.1', 'XP_006362214.1'], 'Sorghum_bicolor': ['YP_899397.1', 'XP_021305150.1', 'XP_021305151.1', 'XP_00
2436683.2', 'XP_002468227.1', 'XP_002445131.1', 'XP_021314715.1', 'XP_002451417.2', 'XP_021304137.1', 'XP_021320128.1', 'XP_002447199.1'], 'Spinacia_oleracea': ['XP_021848419.1', 'NP_054924.1', 'XP_021852019.
1', 'XP_021864536.1'], 'Tarenaya_hassleriana': ['XP_010520079.1', 'XP_010537598.1', 'XP_019058164.1', 'XP_010537597.1', 'XP_010529417.1', 'XP_010536382.1', 'XP_010538568.1', 'XP_010537599.1', 'XP_010538559.1'
], 'Theobroma_cacao': ['XP_017985035.1', 'XP_017985036.1', 'XP_007011717.2', 'YP_004021309.1', 'XP_017985026.1', 'XP_007025631.1'], 'Trema_orientale': ['PON36064.1', 'PON86208.1', 'PON99231.1', 'PON83619.1',
'PON36069.1'], 'Vitis_riparia': ['XP_034683403.1', 'YP_009527520.1', 'XP_034683404.1', 'XP_034703535.1', 'XP_034703777.1', 'XP_034701577.1', 'XP_034703534.1', 'XP_034703533.1'], 'Vitis_vinifera': ['YP_567068.
1', 'XP_010659084.1', 'XP_010648748.1', 'XP_002283296.1', 'XP_002274051.1', 'XP_010659064.1', 'XP_010659065.1', 'XP_010659083.1', 'XP_010659082.1'], 'Zea_mays': ['NP_001339331.1', 'XP_008644643.1', 'XP_020401
620.1', 'NP_001338873.1', 'XP_008648749.1', 'XP_008662804.1', 'NP_043015.1', 'XP_008664805.1']}
```     
返回的结果是一个字典，字典的索引是物种名，值是家族成员的蛋白ID。


如果需要知道这些蛋白的序列，需要加上 --homologousSeq 参数，并且给定 -S 保存的路径：     
> python plantFamily.py --genefamily -s Oryza_sativa -p  PF04563,PF00562 --homologousSeq -S E:\work\plantFamily\TEST\TEST.fa    

```
Reading json data ...
Finished reading!
Now is searching Oryza_sativa...
Finished searching!
['XP_015614312.1', 'XP_015631661.1', 'XP_015636222.1', 'XP_025880655.1', 'XP_015632810.1', 'NP_039373.1', 'XP_015632812.1', 'XP_025880656.1', 'XP_015632811.1', 'XP_015648872.1']
Searching XP_015614312.1 protein sequence...
Searching XP_015631661.1 protein sequence...
Searching XP_015636222.1 protein sequence...
Searching XP_025880655.1 protein sequence...
Searching XP_015632810.1 protein sequence...
Searching NP_039373.1 protein sequence...
Searching XP_015632812.1 protein sequence...
Searching XP_025880656.1 protein sequence...
Searching XP_015632811.1 protein sequence...
Searching XP_015648872.1 protein sequence...
Protein sequences had writen.
```      
在保存到目录中生成两个文件TEST.fa和TEST.fa.aligned.aln。如果没有.aln文件的话根据提示网址去MUSCLE网址做在线比对也可以。


当然，我们还可以通过蛋白ID回溯到基因ID，获取序列:    

> python plantFamily.py --genefamily -s Oryza_sativa -p  PF04563,PF00562 --homologousSeq -S E:\work\plantFamily\TEST\TEST.fa  -g      
```
Reading json data ...
Finished reading!
Now is searching Oryza_sativa...
Finished searching!
['XP_015632810.1', 'XP_015648872.1', 'XP_015636222.1', 'XP_015614312.1', 'NP_039373.1', 'XP_015632811.1', 'XP_025880655.1', 'XP_015632812.1', 'XP_015631661.1', 'XP_025880656.1']
Searching XP_015632810.1 protein sequence...
Searching XP_015648872.1 protein sequence...
Searching XP_015636222.1 protein sequence...
Searching XP_015614312.1 protein sequence...
Searching NP_039373.1 protein sequence...
Searching XP_015632811.1 protein sequence...
Searching XP_025880655.1 protein sequence...
Searching XP_015632812.1 protein sequence...
Searching XP_015631661.1 protein sequence...
Searching XP_025880656.1 protein sequence...
Protein sequences had writen.
Reading json data ...
Finished reading!
Now is searching Oryza_sativa...
Finished searching!
['XP_015632810.1', 'XP_015648872.1', 'XP_015636222.1', 'XP_015614312.1', 'NP_039373.1', 'XP_015632811.1', 'XP_025880655.1', 'XP_015632812.1', 'XP_015631661.1', 'XP_025880656.1']
XP_015632810.1
Searching XP_015632810.1 gene sequence...
XP_015648872.1
Searching XP_015648872.1 gene sequence...
XP_015636222.1
Searching XP_015636222.1 gene sequence...
XP_015614312.1
Searching XP_015614312.1 gene sequence...
NP_039373.1
Searching NP_039373.1 gene sequence...
XP_015632811.1
Searching XP_015632811.1 gene sequence...
XP_025880655.1
Searching XP_025880655.1 gene sequence...
XP_015632812.1
Searching XP_015632812.1 gene sequence...
XP_015631661.1
Searching XP_015631661.1 gene sequence...
XP_025880656.1
Searching XP_025880656.1 gene sequence...
MUSCLE error, please submit the fasta file to https://www.ebi.ac.uk/Tools/msa/muscle/#
```

这就是plantFamily的主要功能。
后续会开发启动子序列cis-element挖掘、基因(蛋白)motif挖掘。并且在时间允许的条件下增加绘图功能，比如基因(蛋白)结构绘制等。


